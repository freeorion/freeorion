from typing import Any

from typing_extensions import TypeAlias

# Default value for int keyword arguments, use it when default value is not clear
from focs._types import (
    _ID,
    _T,
    _Aggregator,
    _Condition,
    _Effect,
    _EffectGroup,
    _Empire,
    _FloatValue,
    _Focus,
    _FocusType,
    _IntComparableCondition,
    _IntValue,
    _PlanetEnvironment,
    _PlanetId,
    _PlanetSize,
    _PlanetType,
    _Resource,
    _Species,
    _StarType,
    _SystemID,
    _Turn,
    _Value,
    _Visibility,
)

# Placeholders for default function arguments
_SOME_INT = int()
_SOME_FLOAT = float()

Blue = _StarType()
White = _StarType()
Orange = _StarType()
Yellow = _StarType()
Red = _StarType()
Neutron = _StarType()
NoStar = _StarType()
BlackHole = _StarType()

def Object(id) -> _Condition: ...

Invisible = _Visibility()
Basic = _Visibility()
Partial = _Visibility()
Full = _Visibility()

Tiny = _PlanetSize()
Small = _PlanetSize()
Medium = _PlanetSize()
Large = _PlanetSize()
Huge = _PlanetSize()

Swamp = _PlanetType()
Toxic = _PlanetType()
Inferno = _PlanetType()
Radiated = _PlanetType()
Barren = _PlanetType()
Tundra = _PlanetType()
Desert = _PlanetType()
Terran = _PlanetType()
Ocean = _PlanetType()
AsteroidsType = _PlanetType()
GasGiantType = _PlanetType()

Good = _PlanetEnvironment()
Adequate = _PlanetEnvironment()
Poor = _PlanetEnvironment()
Hostile = _PlanetEnvironment()
Uninhabitable = _PlanetEnvironment()

ThisSpecies = _Species()

# Type hints for function arguments.  This could be a literal or _Value returned by other function.
_StringType: TypeAlias = _Value[str] | str
_IntType: TypeAlias = _Value[int] | int
# We assume that we accept int anywhere we could accept float
_FloatType: TypeAlias = _IntType | _Value[float] | float

AnyEmpire = _Empire()
EnemyOf = _Empire()
AllyOf = _Empire()
CurrentTurn = _Turn()

class _SystemInfo:
    LastTurnBattleHere: int
    ID: _ID

class Source:
    """
    FOCS Source is IsSource, this class is fpr Source.<something>
    """

    Owner: _Empire
    ID: _ID
    SystemID: _SystemID
    Species: _Species
    System: _SystemInfo
    TargetPopulation: _FloatValue
    Research: _FloatValue
    Industry: _FloatValue
    HabitableSize: _FloatValue

class LocalCandidate:
    LastTurnConquered: _Turn
    LastTurnActiveInBattle: _Turn
    TurnsSinceFocusChange: _Turn
    LastTurnAttackedByShip: _Turn
    ArrivedOnTurn: int
    ID: _ID
    Owner: _Empire
    Focus: _Focus
    NextSystemID: _SystemID
    System: _SystemInfo
    OrderedColonizePlanetID: _PlanetId
    Species: _Species
    LastInvadedByEmpire: _Empire
    LastColonizedByEmpire: _Empire
    MaxStructure: _FloatValue
    Population: _FloatValue

class RootCandidate:
    Owner: _Empire
    PreviousSystemID: _SystemID

class Target:
    Owner: _Empire
    ID: _ID
    Construction: Any
    PreviousSystemID: _SystemID
    TurnsSinceFocusChange: int
    Population: _FloatValue
    Happiness: _FloatValue
    HabitableSize: _FloatValue
    MaxSupply: _FloatValue
    MaxFuel: _FloatValue
    MaxStructure: _FloatValue
    MaxTroops: _FloatValue
    MaxDefense: _FloatValue
    MaxShield: _FloatValue
    MaxStockpile: _FloatValue
    TargetPopulation: _FloatValue
    TargetResearch: _FloatValue
    TargetInfluence: _FloatValue
    TargetIndustry: _FloatValue
    TargetConstruction: _FloatValue
    TargetHappiness: _FloatValue

def FocusType(
    *,
    name: str,
    description: str,
    location: _Condition,
    graphic: str,
) -> _FocusType: ...

class ValuePlaceHolder(_Value):
    def __call__(self, value) -> _Value: ...

Value = ValuePlaceHolder()

Min = _Aggregator()
Max = _Aggregator()
Sum = _Aggregator()
Mode = _Aggregator()

def OneOf(type_: type[_T], *args: _StringType) -> _Value[_T]: ...
def Abs(type_: type[_T], value: _FloatType) -> _Value[_T]: ...
def MinOf(type_: type[_T], *args: _FloatType) -> _Value[_T]: ...
def MaxOf(type_: type[_T], *args: _FloatType) -> _Value[_T]: ...
def DirectDistanceBetween(target: _ID, source: _ID) -> _FloatValue: ...
def StatisticIf(type_: type[_T], condition: _Condition) -> _Value[_T]: ...
def StatisticCount(type_: type[_T], condition: _Condition) -> _Value[_T]: ...
def Statistic(type_: type[_T], aggregator: _Aggregator, value: _T, condition: _Condition) -> _Value[_T]: ...
def NamedReal(*, name: str, value: _FloatType) -> _FloatValue: ...
def NamedRealLookup(*, name: str) -> _FloatValue: ...
def NamedIntegerLookup(*, name: str) -> _IntValue: ...
def SpeciesShipsDestroyed(empire: _Empire, name: _Species) -> _IntValue: ...
def SpeciesShipsLost(empire: _Empire, name: _Species) -> _IntValue: ...
def SpeciesEmpireTargetOpinion(*, species: _Species, empire: _Empire) -> _FloatValue: ...
def EmpireStockpile(empire: _Empire, resource: _Resource) -> _FloatValue: ...
def PartCapacity(*, name: str) -> _FloatValue: ...
def EffectsGroup(
    *,
    scope: _Condition,
    effects: list[_Effect] | _Effect,
    activation: _Condition | None = None,
    description: str = "",
    priority=None,
    accountinglabel: str = "",
    stackinggroup: str = "",
):
    _EffectGroup

# Conditions
def IsBuilding(*, name: list[str] = []) -> _Condition: ...
def Number(*, low: int, condition: _Condition) -> _Condition: ...
def Planet(
    *, type: list[_PlanetType] = [], environment: list[_PlanetEnvironment] = [], size: list[_PlanetSize] = []
) -> _Condition: ...
def Star(*, type: list[_StarType]) -> _Condition: ...
def HasSpecies(*, name: list[_StringType | _Species] = []) -> _Condition: ...
def Population(*, low: _FloatType = _SOME_FLOAT, high: _FloatType = _SOME_FLOAT) -> _Condition: ...
def TargetPopulation(*, low: _FloatType = _SOME_FLOAT, high: _FloatType = _SOME_FLOAT) -> _Condition: ...
def SpeciesLikes(*, name: _Focus) -> _Condition: ...
def SpeciesDislikes(*, name: _Focus) -> _Condition: ...
def Homeworld(*, name: list[_Species] = []) -> _Condition: ...
def HasTag(*, name: str) -> _Condition: ...
def VisibleToEmpire(*, empire: _Empire) -> _Condition: ...
def ContainedBy(condition: _Condition) -> _Condition: ...
def HasSpecial(*, name: str) -> _Condition: ...
def OwnerHasTech(*, name: str) -> _Condition: ...

System = _Condition()
Ship = _Condition()
Armed = _Condition()
Unowned = _Condition()
Capital = _Condition()
IsHuman = _Condition()
Fleet = _Condition()
Stationary = _Condition()
IsSource = _Condition()
IsTarget = _Condition()

def InSystem(*, id: _SystemID = _SystemID()) -> _Condition: ...

GalaxyMaxAIAggression = _IntComparableCondition()
GalaxyMonsterFrequency = _IntComparableCondition()

def JumpsBetween(source: _ID, target: _ID) -> _IntValue: ...
def TargetIndustry(*, low: int) -> _Condition: ...
def Happiness(*, low: _FloatType) -> _Condition: ...
def Focus(*, type: list[str]) -> _Condition: ...
def Random(*, probability: _FloatType) -> _Condition: ...
def OwnedBy(*, affiliation: _Empire = _Empire(), empire: _Empire = _Empire()) -> _Condition: ...
def WithinStarlaneJumps(*, jumps: _IntType, condition: _Condition) -> _Condition: ...
def WithinDistance(*, distance: int, condition: _Condition) -> _Condition: ...
def ResourceSupplyConnected(*, empire: _Empire, condition: _Condition) -> _Condition: ...
def Contains(scope: _Condition) -> _Condition: ...
def Turn(*, high: int = _SOME_INT, low: int = _SOME_INT) -> _Condition: ...
def Structure(*, high: _FloatValue = _FloatValue()) -> _Condition: ...
def DesignHasPart(*, name: str, low: int = _SOME_INT, high: int = _SOME_INT) -> _Condition: ...
def EmpireHasAdoptedPolicy(*, name: str, empire: _Empire = _Empire()) -> _Condition: ...

Influence = _Resource()

def HasEmpireStockpile(*, empire: _Empire, resource: _Resource, low: int) -> _Condition: ...
def OnPlanet(*, id: _ID) -> _Condition: ...

# Effects
Destroy = _Effect()

_RuleType: TypeAlias = type[float] | type[int] | type[str]

def GameRule(*, type: _RuleType, name: str) -> _FloatType: ...

NoEffect = _Effect()

def Conditional(
    *,
    condition: _Condition,
    effects: list[_Effect],
    else_: list[_Effect],
) -> _Effect: ...
def AddSpecial(*, name: _Value[str] | str) -> _Effect: ...
def RemoveSpecial(*, name: str) -> _Effect: ...
def SetMaxShield(*, value: _FloatType) -> _Effect: ...
def SetShield(*, value: _FloatType) -> _Effect: ...
def SetTargetIndustry(*, value: _FloatType) -> _Effect: ...
def SetDetection(*, value: _FloatType) -> _Effect: ...
def SetStructure(*, value: _FloatType) -> _Effect: ...
def SetFuel(*, value: _FloatType) -> _Effect: ...
def SetDefense(*, value: _FloatType) -> _Effect: ...
def SetMaxTroops(*, value: _FloatType) -> _Effect: ...
def SetStockpile(*, value: _FloatType) -> _Effect: ...
def SetMaxStockpile(*, value: _FloatType) -> _Effect: ...
def SetTargetHappiness(*, value: _FloatType) -> _Effect: ...
def UnlockPolicy(*, name: str, empire: _Empire = _Empire()) -> _Effect: ...
def SetVisibility(empire: _Empire, visibility: Any) -> _Effect: ...
def SetPopulation(*, value: _FloatType) -> _Effect: ...
def SetTroops(*, value: _FloatType) -> _Effect: ...
def SetMaxDefense(*, value: _FloatType) -> _Effect: ...
def SetSupply(*, value: _FloatType) -> _Effect: ...
def SetTargetResearch(*, value: _FloatType) -> _Effect: ...
def SetHappiness(*, value: _FloatType) -> _Effect: ...
def SetPlanetSize(*, planetsize: _PlanetSize) -> _Effect: ...
def SetMaxSupply(*, value: _FloatType) -> _Effect: ...
def SetMaxFuel(*, value: _FloatType) -> _Effect: ...
def SetResearch(*, value: _FloatType) -> _Effect: ...
def SetIndustry(*, value: _FloatType) -> _Effect: ...
def SetInfluence(*, value: _FloatType) -> _Effect: ...
def SetSpeciesTargetOpinion(*, species: _Species, empire: _Empire, opinion: _FloatType) -> _Effect: ...
def SetSpeciesOpinion(*, species: _Species, empire: _Empire, opinion: _FloatType) -> _Effect: ...
def SetTargetPopulation(*, value: _FloatType, accountinglabel: str = "") -> _Effect: ...
def SetTargetInfluence(*, value: _FloatType) -> _Effect: ...
def SetTargetConstruction(*, value: _FloatType) -> _Effect: ...
def SetConstruction(*, value: _FloatType) -> _Effect: ...
def SetRebelTroops(*, value: _FloatType) -> _Effect: ...
def SetStealth(*, value: _FloatType) -> _Effect: ...
def CreateBuilding(*, type: str) -> _Effect: ...
def CreateShip(*, designname: str, species: str = "") -> _Effect: ...
def SetCapacity(*, partname: str, value: _FloatType) -> _Effect: ...
def SetMaxDamage(*, partname: str, value: _FloatType) -> _Effect: ...
def SetMaxSecondaryStat(*, partname: str, value: _FloatType) -> _Effect: ...
def MoveTo(*, destination: _Condition) -> _Effect: ...
def MoveTowards(*, speed: int, target: _Condition) -> _Effect: ...
def SetStarType(*, type: _StarType) -> _Effect: ...
def SetEmpireMeter(vempire: _Empire, meter: str, value: _FloatType) -> _Effect: ...
def GenerateSitRepMessage(
    *,
    message: str,
    label: str,
    parameters: dict[str, Any],
    empire: _Empire,
    icon: str = "",
) -> _Effect: ...
def GiveEmpireTech(*, name: str, empire=_Empire()) -> _Effect: ...
